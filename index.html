<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>The Magical Cat Button</title>

</head>
<style type="text/css">
    button,
    div,
    form,
    input {
        margin: 10px;
    }
</style>

<body>
    <div id="animal-buttons">
    </div>
    <form id="animal-form">
        <label for="animal-input">Add a animal
        </label>
        <input type="text" id="animal-input">
        <br>

        <input id="add-animal" type="submit" value="Submit">
    </form>

    <div id="animals">

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js">
    </script>
    <script type="text/javascript">

        var topics = ["cat", "dog", "goat", "monkey"];

        $("#add-animal").on("click", function (event) {
            event.preventDefault();

            topics.push($("#animal-input").val().trim());
            addButton($("#animal-input").val().trim());
        });

        function addButton(topic) {
            var button = $('<input id="' + topic + '-button" type="button" value="' + topic + '" />');
            button.appendTo($("#animal-buttons"));

            // Event listener for our cat-button
            $("#" + topic + "-button").on("click", function () {

                // Storing our giphy API URL for a random cat image
                var queryURL = "https://api.giphy.com/v1/gifs/search?q=" + topic + "&api_key=s1xlS43zDdNWtmMNCSkzFZc8npdUL6Md&limit=10";

                // Perfoming an AJAX GET request to our queryURL
                $.ajax({
                    url: queryURL,
                    method: "GET"
                })

                    // After the data from the AJAX request comes back
                    .then(function (response) {
                        // Saving the image_original_url property
                        response.data.forEach(dat => {
                            

                            var imageUrl = dat.images.original_still.url;

                            // Creating and storing an image tag
                            var catImage = $("<img>");

                            // Setting the catImage src attribute to imageUrl
                            catImage.attr("src", imageUrl);
                            catImage.attr("alt", "cat image");

                            // Prepending the catImage to the images div
                            //$("#animals").empty();
                            $("#animals").prepend(catImage);
                        });
                    });
            });
        }

        topics.forEach(topic => {
            addButton(topic);
        });
    </script>
</body>

</html>
